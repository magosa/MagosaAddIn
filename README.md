# MagosaAddIn - PowerPoint図形操作補助アドイン

PowerPointでの図形操作を効率化するVSTOアドインです。図形の整列・分割・配置・選択補助機能を提供します。

## 🚀 機能概要

### 📐 図形整列機能
- **基準整列**: 左端・右端・上端・下端揃え
- **隣接整列**: 基準図形に隣接した配置
- **拡張整列**: 等間隔配置・マージン配置・グリッド配置・円形配置

### ✂️ 図形分割機能
- **単一図形分割**: 1つの四角形を指定グリッドに分割
- **複数図形グリッド分割**: 複数図形の範囲内でグリッド分割
- **スタイル保持**: 元図形の書式を新しい図形に継承

### 🎯 選択補助機能
- **同一書式選択**: 基準図形と同じ書式を持つ図形を自動選択
- **選択条件**: 塗りつぶし色・枠線スタイル・シェイプ種類から選択可能
- **リアルタイムプレビュー**: 条件変更時に一致する図形数を表示

## 🛠️ 技術仕様

### 開発環境
- **開発ツール**: Visual Studio 2022
- **言語**: C#
- **フレームワーク**: .NET Framework 4.7.2
- **技術**: VSTO (Visual Studio Tools for Office)
- **配置方式**: ClickOnce

### 対象アプリケーション
- Microsoft PowerPoint (Office 365 / 2019 / 2021)

### アーキテクチャ
MagosaAddIn/
├── Core/ # ビジネスロジック層
│ ├── ShapeAligner.cs # 図形整列機能
│ ├── ShapeDivider.cs # 図形分割機能
│ ├── ShapeSelector.cs # 図形選択補助機能
│ ├── ShapeStyle.cs # 図形スタイル管理
│ ├── Constants.cs # 定数定義
│ ├── ComExceptionHandler.cs # COM例外処理統一
│ ├── ErrorHandler.cs # エラーハンドリング統一
│ └── DataModels.cs # 共通データクラス
├── UI/ # ユーザーインターフェース層
│ ├── CustomRibbon.cs # リボンUI制御
│ ├── CustomRibbon.Designer.cs # リボンUIデザイン
│ ├── DialogClasses.cs # 各種設定ダイアログ
│ └── RibbonHelper.cs # リボン共通処理
└── Properties/ # アセンブリ情報

## 📋 機能詳細
### 🔧 図形整列機能
#### 基準整列
| 機能 | 説明 |
|------|------|
| 左端揃え | 基準図形の左端に他図形を揃える |
| 右端揃え | 基準図形の右端に他図形を揃える |
| 上端揃え | 基準図形の上端に他図形を揃える |
| 下端揃え | 基準図形の下端に他図形を揃える |

#### 隣接整列
| 機能 | 説明 |
|------|------|
| 左端→右端隣接 | 基準図形の左端に他図形の右端を隣接 |
| 右端→左端隣接 | 基準図形の右端に他図形の左端を隣接 |
| 上端→下端隣接 | 基準図形の上端に他図形の下端を隣接 |
| 下端→上端隣接 | 基準図形の下端に他図形の上端を隣接 |

#### 拡張整列
| 機能 | 説明 |
|------|------|
| 水平中央・等間隔 | 水平中央揃え＋等間隔配置 |
| 垂直中央・等間隔 | 垂直中央揃え＋等間隔配置 |
| 水平マージン配置 | 任意マージンで水平配置 |
| 垂直マージン配置 | 任意マージンで垂直配置 |
| グリッド配置 | 指定列数でグリッド状配置 |
| 円形配置 | 指定中心・半径で円形配置 |

### ✂️ 図形分割機能
#### 単一図形分割
- 1つの四角形を指定した行×列のグリッドに分割
- 元図形のスタイル（塗りつぶし・枠線・影）を保持
- 水平・垂直マージンを個別設定可能
- 
#### 複数図形グリッド分割
- 複数図形の範囲内でグリッド分割を実行
- 元図形削除の選択可能
- 四角形以外の図形に対する警告表示
- 
### 🎯 選択補助機能
#### 選択条件
| 条件 | 説明 |
|------|------|
| 塗りのカラーコード | RGB値が同じ図形を選択 |
| 枠線のスタイル | 色・太さ・破線パターンが同じ図形を選択 |
| 塗りと枠線のスタイル | 塗りつぶしと枠線の両方が同じ図形を選択 |
| シェイプの種類 | 四角形・円・三角形など同じ種類の図形を選択 |

#### 特徴
- **基準図形も含む選択**: 基準図形と条件に合致する全ての図形を選択
- **リアルタイムプレビュー**: 条件変更時に一致する図形数を即座に表示
- **詳細なシェイプ判定**: オートシェイプの具体的な形状まで識別
- 
## 🎨 ユーザーインターフェース
### リボンUI構成
**タブ名**: "Magosa Tools"
| グループ | 機能 |
|----------|------|
| 図形操作 | グリッド分割 |
| 基準整列 | 左端・右端・上端・下端揃え |
| 隣接整列 | 各方向の隣接配置 |
| 拡張整列 | 等間隔・マージン・グリッド・円形配置 |
| 選択補助 | 同一書式選択 |

### ダイアログ
- **DivisionDialog**: 単一図形分割設定
- **GridDivisionDialog**: 複数図形グリッド分割設定
- **MarginDialog**: マージン値設定
- **GridArrangementDialog**: グリッド配置設定
- **CircleArrangementDialog**: 円形配置設定
- **ShapeSelectionDialog**: 図形選択条件設定
- 
## 🔧 技術的特徴
### COM Interop対応
- **事前情報取得方式**: COM参照問題を回避
- **安全な削除処理**: COM例外を考慮した図形削除
- **有効性チェック**: スライド・図形参照の検証
- 
### エラーハンドリング
- **統一されたCOM例外処理**: 全クラスで一貫した例外処理
- **詳細なログ出力**: デバッグとトラブルシューティング対応
- **ユーザーフレンドリーなメッセージ**: 分かりやすいエラー表示
- 
### 設計パターン
- **責任分離**: UI層・ビジネスロジック層・データ層の分離
- **統一されたインターフェース**: 一貫したメソッド設計
- **拡張性**: 新機能追加が容易な設計
- 
## 📊 制限事項
| 項目 | 制限値 |
|------|--------|
| 座標範囲 | -10,000pt ～ 10,000pt |
| 最小セルサイズ | 5pt |
| 最大分割数 | 50×50 |
| 対象図形（分割） | 四角形のみ |
| 選択補助（最小図形数） | 1個以上 |
| 整列（最小図形数） | 2個以上 |

## 🚀 使用方法
### 基本操作
1. PowerPointで図形を選択
2. "Magosa Tools"タブから機能を選択
3. 必要に応じてダイアログで設定を入力
4. 実行
1. 
### 図形選択要件
- **整列機能**: 2つ以上の図形が必要
- **分割機能**: 1つ以上の四角形が必要
- **選択補助**: 1つの図形を基準として選択

## 📄 ライセンス
このプロジェクトは個人・商用利用可能です。詳細はライセンスファイルを参照してください。
## 🐛 バグレポート・機能要望
バグレポートや機能要望は、GitHubのIssuesページでお知らせください。
---
**MagosaAddIn** - PowerPointでの図形操作をより効率的に！