# MagosaAddIn - PowerPoint図形操作補助アドイン

PowerPointでの図形操作を効率化するVSTOアドインです。図形の整列・分割・配置・選択補助・ハンドル調整・レイヤー管理・ナンバリング・置き換え・サイズ調整・配列複製・テーマカラー生成機能を提供します。

## 🚀 機能概要

### 📐 図形整列機能
- **基準整列**: 左端・右端・上端・下端・水平中央・垂直中央揃え
- **隣接整列**: 基準図形に隣接した配置
- **拡張整列**: 等間隔配置・マージン配置・グリッド配置・円形配置

### ✂️ 図形分割機能
- **単一図形分割**: 1つの四角形を指定グリッドに分割
- **複数図形グリッド分割**: 複数図形の範囲内でグリッド分割
- **スタイル保持**: 元図形の書式を新しい図形に継承

### 🎯 選択補助機能
- **同一書式選択**: 基準図形と同じ書式を持つ図形を自動選択
- **選択条件**: 塗りつぶし色・枠線スタイル・シェイプ種類から選択可能
- **リアルタイムプレビュー**: 条件変更時に一致する図形数を表示

### 🔧 図形ハンドル調整機能
- **調整ハンドル設定**: 角丸・矢印・星形などの図形パラメータを一括調整
- **角度ハンドル設定**: 円弧・扇形・ブロック円弧などの角度を度数単位で設定
- **単位変換対応**: mm単位、度数単位での直感的な値入力
- **調整リセット**: すべての調整ハンドルをデフォルト値に戻す

### 📚 レイヤー（重なり順）調整機能
- **選択順配置**: 選択した順番に前面・背面へ配置
- **位置基準配置**: 左から右、上から下の順に前面へ配置
- **重なり制御**: 複雑な図形の重なり順を簡単に整理

### 🔢 自動ナンバリング機能
- **多様なフォーマット**: 算用数字、丸数字、アルファベット、ローマ数字
- **柔軟な設定**: 開始番号・増分値・フォントサイズを指定可能
- **テキスト継承**: 既存テキストの先頭に番号を追加
- **単一図形対応**: 1個の図形からナンバリング可能

### 🔄 図形置き換え機能
- **一括置き換え**: 複数図形をテンプレート図形で一括置換
- **サイズ選択**: 元のサイズ維持 or テンプレートサイズ統一
- **属性継承**: スタイル（塗り・線・影）とテキストの継承オプション
- **中心位置保持**: 置き換え後も図形の中心位置を維持

### 📏 図形サイズ調整機能
- **基準サイズ適用**: 最初の図形を基準に、他の図形を同じサイズに調整
- **比率保持リサイズ**: 幅または高さを統一し、アスペクト比を保持
- **最大/最小サイズ統一**: 選択図形の中で最大または最小のサイズに統一
- **パーセント拡大縮小**: 全図形を指定%（10～500%）で拡大縮小
- **固定サイズ設定**: mm/cm/pt単位でサイズを直接指定
- **中心位置保持**: リサイズ後も図形の中心位置を維持

### 🔁 配列複製機能
- **線形配列**: 指定方向・個数・間隔で図形を複製配列
- **円形配列**: 等分配置または角度指定で円形に配列
- **グリッド配列**: 行×列で格子状に配列、角度回転も可能
- **パス配列**: カスタムパス（線）に沿って配列
- **回転コピー**: 指定角度ずつ回転させながら複製

### 🎨 テーマカラー生成機能
- **17種類の配色パターン**: 色相ベース、トーンベース、コントラスト配色
- **色空間変換**: RGB⇔HSL⇔HSV変換、16進数カラーコード対応
- **明度バリエーション**: 基準色から明暗方向に段階的展開（1～10段階）
- **カラーパレット配置**: スライド枠外に自動配置
- **図形への色適用**: 選択図形に順番またはランダムで色を適用

## 🛠️ 技術仕様

### 開発環境
- **開発ツール**: Visual Studio 2022
- **言語**: C#
- **フレームワーク**: .NET Framework 4.7.2
- **技術**: VSTO (Visual Studio Tools for Office)
- **配置方式**: ClickOnce
- **バージョン**: 1.0.7

### 対象アプリケーション
- Microsoft PowerPoint (Office 365 / 2019 / 2021)

### アーキテクチャ
```
MagosaAddIn/
├── Core/                          # ビジネスロジック層
│   ├── ShapeAligner.cs           # 図形整列機能
│   ├── ShapeDivider.cs           # 図形分割機能
│   ├── ShapeSelector.cs          # 図形選択補助機能
│   ├── ShapeHandleAdjuster.cs    # 図形ハンドル調整機能
│   ├── ShapeLayerManager.cs      # レイヤー（重なり順）管理
│   ├── ShapeNumbering.cs         # 自動ナンバリング機能
│   ├── ShapeReplacer.cs          # 図形置き換え機能
│   ├── ShapeResizer.cs           # 図形サイズ調整機能
│   ├── ShapeArrayer.cs           # 配列複製機能
│   ├── ThemeColorGenerator.cs    # テーマカラー生成機能
│   ├── ColorConverter.cs         # 色空間変換ユーティリティ
│   ├── ColorPaletteArranger.cs   # カラーパレット配置機能
│   ├── ShapeStyle.cs             # 図形スタイル管理
│   ├── Constants.cs              # 定数定義
│   ├── ComExceptionHandler.cs    # COM例外処理統一
│   ├── ErrorHandler.cs           # エラーハンドリング統一
│   └── DataModels.cs             # 共通データクラス
├── UI/                            # ユーザーインターフェース層
│   ├── CustomRibbon.cs           # リボンUI制御
│   ├── CustomRibbon.Designer.cs  # リボンUIデザイン
│   ├── RibbonHelper.cs           # リボン共通処理
│   └── Dialogs/                  # ダイアログモジュール
│       ├── BaseDialog.cs         # ダイアログ基底クラス
│       ├── CircleArrangementDialog.cs      # 円形配置設定
│       ├── CircularArrayDialog.cs          # 円形配列設定
│       ├── DivisionDialog.cs               # 単一図形分割設定
│       ├── DynamicAngleHandleDialog.cs     # 角度ハンドル設定（動的UI）
│       ├── DynamicHandleDialog.cs          # 調整ハンドル設定（動的UI）
│       ├── GridArrangementDialog.cs        # グリッド配置設定
│       ├── GridArrayDialog.cs              # グリッド配列設定
│       ├── GridDivisionDialog.cs           # 複数図形グリッド分割設定
│       ├── LayerAdjustmentDialog.cs        # レイヤー調整方法選択
│       ├── LinearArrayDialog.cs            # 線形配列設定
│       ├── MarginDialog.cs                 # マージン値設定
│       ├── NumberingDialog.cs              # 自動ナンバリング設定
│       ├── PathArrayDialog.cs              # パス配列設定
│       ├── RotationCopyDialog.cs           # 回転コピー設定
│       ├── ShapeReplacementDialog.cs       # 図形置き換えオプション設定
│       ├── ShapeResizeDialog.cs            # サイズ調整設定
│       ├── ShapeSelectionDialog.cs         # 図形選択条件設定
│       └── ThemeColorDialog.cs             # テーマカラー生成設定
└── Properties/                    # アセンブリ情報
```

## 📋 機能詳細

### 🔧 図形整列機能

#### 基準整列
| 機能 | 説明 |
|------|------|
| 左端揃え | 基準図形の左端に他図形を揃える |
| 右端揃え | 基準図形の右端に他図形を揃える |
| 上端揃え | 基準図形の上端に他図形を揃える |
| 下端揃え | 基準図形の下端に他図形を揃える |
| 水平中央揃え | 基準図形の水平中央に他図形を揃える |
| 垂直中央揃え | 基準図形の垂直中央に他図形を揃える |

#### 隣接整列
| 機能 | 説明 |
|------|------|
| 左端→右端隣接 | 基準図形の左端に他図形の右端を隣接 |
| 右端→左端隣接 | 基準図形の右端に他図形の左端を隣接 |
| 上端→下端隣接 | 基準図形の上端に他図形の下端を隣接 |
| 下端→上端隣接 | 基準図形の下端に他図形の上端を隣接 |

#### 拡張整列
| 機能 | 説明 |
|------|------|
| 水平中央・等間隔 | 水平中央揃え＋等間隔配置 |
| 垂直中央・等間隔 | 垂直中央揃え＋等間隔配置 |
| 水平マージン配置 | 任意マージンで水平配置 |
| 垂直マージン配置 | 任意マージンで垂直配置 |
| グリッド配置 | 指定列数でグリッド状配置 |
| 円形配置 | 指定中心・半径で円形配置 |

### ✂️ 図形分割機能

#### 単一図形分割
- 1つの四角形を指定した行×列のグリッドに分割
- 元図形のスタイル（塗りつぶし・枠線・影）を保持
- 水平・垂直マージンを個別設定可能

#### 複数図形グリッド分割
- 複数図形の範囲内でグリッド分割を実行
- 元図形削除の選択可能
- 四角形以外の図形に対する警告表示

### 🎯 選択補助機能

#### 選択条件
| 条件 | 説明 |
|------|------|
| 塗りのカラーコード | RGB値が同じ図形を選択 |
| 枠線のスタイル | 色・太さ・破線パターンが同じ図形を選択 |
| 塗りと枠線のスタイル | 塗りつぶしと枠線の両方が同じ図形を選択 |
| シェイプの種類 | 四角形・円・三角形など同じ種類の図形を選択 |

#### 特徴
- **基準図形も含む選択**: 基準図形と条件に合致する全ての図形を選択
- **リアルタイムプレビュー**: 条件変更時に一致する図形数を即座に表示
- **詳細なシェイプ判定**: オートシェイプの具体的な形状まで識別

### 🔧 図形ハンドル調整機能

#### 調整ハンドル設定
| 機能 | 説明 |
|------|------|
| 正規化値設定 | PowerPoint内部形式（0.0～1.0）での設定 |
| mm単位設定 | 直感的なmm単位での設定（自動変換） |
| 一括設定 | 複数図形のハンドルを同時に調整 |
| 調整リセット | すべてのハンドルをデフォルト値に戻す |

#### 角度ハンドル設定
| 機能 | 説明 |
|------|------|
| 度数単位設定 | 0～360度での直感的な角度指定 |
| 左回り基準 | 反時計回り（左回り）での角度入力 |
| 図形タイプ別変換 | 円弧・扇形・ブロック円弧など図形別に最適化 |
| 内径比率設定 | ドーナツ・ブロック円弧の内径をパーセント指定 |

#### 対応図形タイプ
**調整ハンドル対応図形**:
- 四角形系: 角丸四角形、切り取り角、各種角処理
- 矢印系: 各種矢印、山形、矢じり調整
- 星形系: 4pt～32pt星、内側頂点位置調整
- 吹き出し: 四角形・円形・雲形の吹き出し線位置調整
- その他: 平行四辺形、台形、リボン、スクロールなど80種類以上

**角度ハンドル対応図形**:
- 円弧、弦、扇形（部分円）
- ブロック円弧（開始角度・終了角度・内径比率）
- ドーナツ（内径比率）
- 三日月（角度調整）

### 📚 レイヤー（重なり順）調整機能

#### 調整方法
| 機能 | 説明 |
|------|------|
| 選択順に前面へ配置 | 選択した順番に図形を前面へ配置 |
| 選択順に背面へ配置 | 選択した順番に図形を背面へ配置 |
| 左から右へ前面に配置 | 左側の図形を背面、右側を前面に配置 |
| 上から下へ前面に配置 | 上側の図形を背面、下側を前面に配置 |

### 🔢 自動ナンバリング機能

#### 番号フォーマット
| フォーマット | 例 | 説明 |
|------------|-----|------|
| 算用数字 | 1, 2, 3... | 標準的な数字表記 |
| 丸数字 | ①②③... | Unicode丸数字（①～㊿まで対応） |
| 大文字アルファベット | A, B, C... | 大文字での連番 |
| 小文字アルファベット | a, b, c... | 小文字での連番 |
| ローマ数字大文字 | I, II, III... | 大文字ローマ数字（1～3999） |
| ローマ数字小文字 | i, ii, iii... | 小文字ローマ数字（1～3999） |

#### 設定項目
- **開始番号**: 0～999の範囲で指定
- **増分値**: -10～+10の範囲で指定（マイナス値で逆順も可能）
- **フォントサイズ**: ポイント単位で指定
- **既存テキスト**: 既存テキストがある場合は先頭に番号を追加

### 🔄 図形置き換え機能

#### 置き換えプロセス
1. **選択完了**: 置き換え対象の図形を複数選択して記憶
2. **テンプレート選択**: 置き換えに使用する図形を1つ選択
3. **オプション設定**: サイズモード・スタイル継承・テキスト継承を選択
4. **置き換え実行**: 記憶した図形をテンプレート図形で一括置換

#### サイズモード
| モード | 説明 |
|--------|------|
| 元のサイズを維持 | 各図形の元のサイズを保持して置換 |
| テンプレートサイズに統一 | すべての図形をテンプレートサイズに統一 |

#### 継承オプション
| オプション | 説明 |
|-----------|------|
| スタイル継承 | 元図形の塗りつぶし・枠線・影を新図形に適用 |
| テキスト継承 | 元図形のテキストを新図形に適用 |

#### 特徴
- **中心位置保持**: 置き換え後も各図形の中心位置を維持
- **一括処理**: 複数図形を一度に効率的に置換
- **安全な削除**: COM例外を考慮した元図形の削除処理

### 📏 図形サイズ調整機能

#### 基準サイズ適用
| 機能 | 説明 |
|------|------|
| 基準サイズ適用 | 最初の図形を基準に、他の図形を同じサイズに調整 |
| 幅統一（比率保持） | 基準図形の幅に合わせ、アスペクト比を保って高さを調整 |
| 高さ統一（比率保持） | 基準図形の高さに合わせ、アスペクト比を保って幅を調整 |

#### サイズ統一
| 機能 | 説明 |
|------|------|
| 最大サイズ統一 | 選択図形の中で最も大きい図形（面積基準）のサイズに統一 |
| 最小サイズ統一 | 選択図形の中で最も小さい図形（面積基準）のサイズに統一 |

#### 詳細サイズ設定
| 機能 | 説明 |
|------|------|
| パーセント拡大縮小 | 全図形を指定%（10～500%）で拡大縮小 |
| 固定サイズ設定 | mm/cm/pt単位でサイズを直接指定 |
| 比率保持オプション | 固定サイズ設定時にアスペクト比を維持 |

#### 特徴
- **中心位置保持**: リサイズ後も図形の中心位置を維持（KeepCenterモード）
- **多様な単位対応**: ポイント（pt）、ミリメートル（mm）、センチメートル（cm）
- **柔軟な設定**: ダイアログで詳細設定が可能
- **一括処理**: 複数図形を一度に効率的にリサイズ

### 🔁 配列複製機能

#### 線形配列（LinearArray）
- **指定方向・個数・間隔で図形を複製配列**
- 角度: 0～360度（0°=右、90°=下、180°=左、270°=上）
- 個数: 2～100個
- 間隔: -200pt～500pt（マイナス値で逆方向配列可能）

#### 円形配列（CircularArray）
**2つのモード**:
1. **等分配置モード**: 指定半径の円周上に等間隔で配置
   - 半径: 10pt～500pt
   - 個数: 2～100個
   - 開始角度: 0～360度
   - 回転中心: 図形中心 or カスタム座標

2. **角度指定モード**: 指定角度ずつ回転させながら配列
   - 角度ステップ: -360度～360度
   - 図形回転オプション: 接線方向に回転可能

#### グリッド配列（GridArray）
- **行×列で格子状に配列**
- 行数: 1～50行
- 列数: 1～50列
- 水平間隔・垂直間隔を個別に設定
- **角度回転対応**: グリッド全体を0～360度で回転可能
- 行数1 = 横方向線形配列、列数1 = 縦方向線形配列として動作

#### パス配列（PathArray）
- **カスタムパス（線図形）に沿って配列**
- 等間隔配置 or カスタム間隔
- パスに沿った回転オプション
- 線図形の始点から終点まで均等配置

#### 回転コピー（RotationCopy）
- **指定角度ずつ回転させながら複製**
- 回転角度: -360度～360度
- 回転中心: 図形中心 or カスタム座標
- 元の図形の相対位置を維持しながら回転

### 🎨 テーマカラー生成機能

#### 17種類の配色パターン

**色相ベース配色（9種類）**:
1. **Dyad（ダイアード）**: 補色関係（色相環で180°反対）
2. **Triad（トライアド）**: 3等分配色（120°間隔）
3. **Tetrad（テトラード）**: 4等分配色（90°間隔）
4. **Pentad（ペンタード）**: 5等分配色（72°間隔）
5. **Hexad（ヘクサード）**: 6等分配色（60°間隔）
6. **Analogy（アナロジー）**: 類似色（30°間隔の近接色）
7. **Intermediate（インターミディエート）**: 中間色（90°）
8. **Opponent（オポーネント）**: 対立色（135°）
9. **SplitComplementary（スプリットコンプリメンタリー）**: 補色の分割（180°±30°）

**トーンベース配色（7種類）**:
10. **ToneOnTone（トーンオントーン）**: 同色相・明度差大（20%～90%の明度範囲）
11. **ToneInTone（トーンイントーン）**: トーン統一・色相変化（明度・彩度固定で色相分散）
12. **Camaieu（カマイユ）**: 色相・トーン近似（色相差±5°、彩度差±10%）
13. **FauxCamaieu（フォカマイユ）**: カマイユより色相変化大（色相差±15°、彩度差±20%）
14. **DominantColor（ドミナントカラー）**: 同色相統一（彩度30%～100%、明度30%～90%で変化）
15. **Identity（アイデンティティ）**: 1色相・明度彩度変化（グラデーション的変化）
16. **Gradation（グラデーション）**: 色相・明度・彩度を段階的に変化（開始色→終了色）

**コントラスト配色（3種類）**:
17. **HueContrast（色相コントラスト）**: 補色関係による対比
18. **LightnessContrast（明度コントラスト）**: 明暗対比（明るい⇔暗い）
19. **SaturationContrast（彩度コントラスト）**: 鮮やか⇔くすみの対比

#### 色空間変換機能（ColorConverter）
- **RGB⇔HSL変換**: PowerPointのRGB値（0xBBGGRR形式）と色相・彩度・明度の相互変換
- **RGB⇔HSV変換**: RGB値と色相・彩度・明度（Value）の相互変換
- **16進数カラーコード対応**: #RRGGBB形式との相互変換
- **補色計算**: 色相を180度回転して補色を生成
- **System.Drawing.Color互換**: .NETカラー型との相互変換

#### 明度バリエーション生成
- **段階数**: 1～10段階で指定可能
- **展開方向**: 基準色を中心に明暗両方向に展開
- **明るい側**: 基準色から95%明度まで
- **暗い側**: 基準色から10%明度まで
- **グリッド配置**: 色×明度段階の2次元カラーグリッドを生成

#### カラーパレット配置機能（ColorPaletteArranger）
- **スライド枠外配置**: 右側または下側に自動配置
- **セルサイズ**: 10pt～50pt（デフォルト20pt）
- **カラーコード表示**: 各セルに#RRGGBB形式のコードを表示
- **テキスト色自動調整**: 背景色の明度に応じて黒/白を自動選択
- **グリッド/行配置**: 明度バリエーション付きグリッドまたは単一行配置

#### 図形への色適用
- **適用モード**:
  - **順番適用（Sequential）**: 色リストの順番通りに適用
  - **ランダム適用（Random）**: 色をランダムに選択して適用
- **複数図形対応**: 色数より図形数が多い場合は循環適用
- **塗りつぶし色のみ**: 枠線色や影は変更せず、塗りつぶし色のみを適用

## 🎨 ユーザーインターフェース

### リボンUI構成
**タブ名**: "Magosa Tools"

| グループ | 機能 |
|----------|------|
| 図形操作 | グリッド分割 |
| 基準整列 | 左端・右端・上端・下端・水平中央・垂直中央揃え |
| 隣接整列 | 各方向の隣接配置 |
| 拡張整列 | 等間隔・マージン・グリッド・円形配置 |
| 選択補助 | 同一書式選択 |
| ハンドル調整 | 調整ハンドル・角度ハンドル・調整リセット |
| レイヤー調整 | 重なり順の調整 |
| 自動ナンバリング | 図形への番号付け |
| 図形置き換え | 選択完了・置き換え実行 |
| サイズ調整 | 基準サイズ適用・幅統一・高さ統一・最大/最小サイズ統一・詳細設定 |
| 配列複製 | 円形配列・グリッド配列 |
| テーマカラー | カラー生成 |

### ダイアログ
#### 共通基盤
- **BaseDialog**: 全ダイアログの基底クラス
  - **統一されたレイアウト定数**: マージン、スペース、ボタンサイズ等を一元管理
  - **共通コントロール作成メソッド**: Label、NumericUpDown、Button等を統一的に生成
  - **レスポンシブボタン配置**: カスタムサイズ対応の自動ボタン配置機能
  - **DRY原則の徹底**: コード重複を削減し保守性を大幅向上

#### 機能別ダイアログ
- **DivisionDialog**: 単一図形分割設定
- **GridDivisionDialog**: 複数図形グリッド分割設定
- **MarginDialog**: マージン値設定
- **GridArrangementDialog**: グリッド配置設定
- **CircleArrangementDialog**: 円形配置設定
- **ShapeSelectionDialog**: 図形選択条件設定
- **DynamicHandleDialog**: 調整ハンドル設定（動的UI生成）
- **DynamicAngleHandleDialog**: 角度ハンドル設定（動的UI生成）
- **LayerAdjustmentDialog**: レイヤー調整方法選択
- **NumberingDialog**: 自動ナンバリング設定
- **ShapeReplacementDialog**: 図形置き換えオプション設定
- **ShapeResizeDialog**: サイズ調整設定（パーセント/固定サイズ）
- **CircularArrayDialog**: 円形配列設定（等分配置/角度指定）
- **GridArrayDialog**: グリッド配列設定
- **LinearArrayDialog**: 線形配列設定
- **PathArrayDialog**: パス配列設定
- **RotationCopyDialog**: 回転コピー設定
- **ThemeColorDialog**: テーマカラー生成設定（17種類の配色パターン）

## 🔧 技術的特徴

### COM Interop対応
- **事前情報取得方式**: COM参照問題を回避
- **安全な削除処理**: COM例外を考慮した図形削除
- **有効性チェック**: スライド・図形参照の検証

### エラーハンドリング
- **統一されたCOM例外処理**: 全クラスで一貫した例外処理
- **詳細なログ出力**: デバッグとトラブルシューティング対応
- **ユーザーフレンドリーなメッセージ**: 分かりやすいエラー表示

### 設計パターン
- **責任分離**: UI層・ビジネスロジック層・データ層の分離
- **統一されたインターフェース**: 一貫したメソッド設計
- **拡張性**: 新機能追加が容易な設計
- **継承による共通化**: BaseDialogによるダイアログの統一設計
- **DRY原則**: 重複コードの削減（IsRectangleShape等のメソッド統一）
- **パラメータ化**: 柔軟な設定を可能にするパラメータ設計

### パフォーマンス最適化
- **高速分析**: 図形ハンドル情報の高速取得（キャッシュ機構）
- **一括処理**: 複数図形の効率的な一括操作
- **メモリ管理**: 適切なCOMオブジェクトの解放

### UI/UXの統一
- **レイアウト定数による一元管理**:
  - DefaultMargin = 20px
  - StandardVerticalSpacing = 30px
  - ButtonTopMargin = 30px
  - ButtonBottomMargin = 60px
  - ButtonSpacing = 10px
  - ButtonRightMargin = 20px
- **動的レイアウト計算**: ボタン位置・フォーム高さを自動計算
- **カスタムサイズ対応**: ボタンサイズに応じた位置調整
- **統一された見た目**: すべてのダイアログで一貫したマージン・パディング

## 📊 制限事項

| 項目 | 制限値 |
|------|--------|
| 座標範囲 | -10,000pt ～ 10,000pt |
| 最小セルサイズ | 5pt |
| 最大分割数 | 50×50 |
| 対象図形（分割） | 四角形のみ |
| 選択補助（最小図形数） | 1個以上 |
| 整列（最小図形数） | 2個以上 |
| ハンドル調整（最小図形数） | 1個以上 |
| レイヤー調整（最小図形数） | 2個以上 |
| ナンバリング（最小図形数） | 1個以上 |
| 図形置き換え（最小図形数） | 1個以上 |
| サイズ調整（最小図形数） | 1個以上 |
| 配列複製（最小図形数） | 1個以上 |
| テーマカラー（最小図形数） | 0個以上（図形なしでも可） |
| 最大調整ハンドル数 | 8個 |
| ナンバリング開始番号 | 0～999 |
| ナンバリング増分値 | -10～+10 |
| サイズ調整パーセント範囲 | 10%～500% |
| 配列個数範囲 | 2～100個 |
| 配列間隔範囲 | -200pt～500pt |
| 配列回転角度範囲 | -360度～360度 |
| 配列行数・列数範囲 | 1～50 |
| テーマカラー色数範囲 | 2～10色 |
| 明度バリエーション段階数 | 1～10段階 |
| パレットセルサイズ | 10pt～50pt |

## 🚀 使用方法

### 基本操作
1. PowerPointで図形を選択
2. "Magosa Tools"タブから機能を選択
3. 必要に応じてダイアログで設定を入力
4. 実行

### 図形選択要件
- **整列機能**: 2つ以上の図形が必要
- **分割機能**: 1つ以上の四角形が必要
- **選択補助**: 1つの図形を基準として選択
- **ハンドル調整**: 1つ以上の対応図形が必要
- **レイヤー調整**: 2つ以上の図形が必要
- **ナンバリング**: 1つ以上の図形が必要
- **図形置き換え**: 記憶は1つ以上、テンプレートは1つ

### 図形ハンドル調整の使い方
1. 調整可能な図形（角丸四角形、矢印、星形、円弧など）を選択
2. 「調整ハンドル」または「角度ハンドル」ボタンをクリック
3. 動的に生成されたUIでハンドル値を入力
4. プレビューで確認しながら「適用」をクリック

### 図形置き換えの使い方
1. 置き換えたい図形を複数選択し「選択完了」をクリック
2. テンプレートにする図形を1つ選択
3. 「置き換え実行」をクリックしてオプションを設定
4. 実行すると記憶した図形がテンプレート図形で置き換わる

## 📄 ライセンス
このプロジェクトは個人・商用利用可能です。詳細はライセンスファイルを参照してください。

## 🐛 バグレポート・機能要望
バグレポートや機能要望は、GitHubのIssuesページでお知らせください。

## 📝 更新履歴

### Version 1.0.7 (2026年2月20日)
- **📏 図形サイズ調整機能の追加**:
  - **ShapeResizer.cs**: 図形のサイズを統一・調整する機能
    - 基準サイズ適用（最初の図形を基準に統一）
    - 比率保持リサイズ（幅または高さを統一し、アスペクト比保持）
    - 最大/最小サイズ統一（面積基準で選択図形の最大/最小サイズに統一）
    - パーセント拡大縮小（10～500%）
    - 固定サイズ設定（mm/cm/pt単位で直接指定）
    - 中心位置保持オプション
  - **ShapeResizeDialog.cs**: サイズ調整の詳細設定ダイアログ

- **🔁 配列複製機能の追加**:
  - **ShapeArrayer.cs**: 図形を様々なパターンで配列複製
    - 線形配列（LinearArray）: 指定方向・個数・間隔で配列
    - 円形配列（CircularArray）: 等分配置または角度指定で円形配列
    - グリッド配列（GridArray）: 行×列で格子状配列、角度回転対応
    - パス配列（PathArray）: カスタムパスに沿って配列
    - 回転コピー（RotationCopy）: 指定角度ずつ回転させながら複製
  - **配列ダイアログ群**:
    - CircularArrayDialog.cs（等分配置/角度指定の2モード）
    - GridArrayDialog.cs（行列設定・回転角度対応）
    - LinearArrayDialog.cs（方向・個数・間隔設定）
    - PathArrayDialog.cs（パスに沿った配列）
    - RotationCopyDialog.cs（回転複製設定）

- **🎨 テーマカラー生成機能の追加**:
  - **ThemeColorGenerator.cs**: 17種類の配色パターンによるカラー生成
    - **色相ベース配色（9種類）**: Dyad、Triad、Tetrad、Pentad、Hexad、Analogy、Intermediate、Opponent、SplitComplementary
    - **トーンベース配色（7種類）**: ToneOnTone、ToneInTone、Camaieu、FauxCamaieu、DominantColor、Identity、Gradation
    - **コントラスト配色（3種類）**: HueContrast、LightnessContrast、SaturationContrast
    - 明度バリエーション生成（1～10段階）
  - **ColorConverter.cs**: 色空間変換ユーティリティ
    - RGB⇔HSL⇔HSV変換
    - 16進数カラーコード（#RRGGBB）対応
    - 補色計算・System.Drawing.Color互換
  - **ColorPaletteArranger.cs**: カラーパレットの自動配置
    - スライド枠外配置（右側/下側）
    - カラーコード表示付きセル生成
    - テキスト色の自動調整（背景明度に応じて黒/白）
  - **ThemeColorDialog.cs**: テーマカラー生成設定ダイアログ
    - 配色パターン選択（17種類）
    - 基準色・色数・明度段階数の設定
    - パレット配置・図形適用オプション

- **🎨 リボンUI拡張**:
  - サイズ調整グループ: 基準サイズ適用、幅統一、高さ統一、最大/最小サイズ統一、詳細設定
  - 配列複製グループ: 円形配列、グリッド配列
  - テーマカラーグループ: カラー生成

- **📊 制限事項の追加**:
  - サイズ調整パーセント範囲: 10%～500%
  - 配列個数範囲: 2～100個
  - 配列間隔範囲: -200pt～500pt
  - 配列回転角度範囲: -360度～360度
  - 配列行数・列数範囲: 1～50
  - テーマカラー色数範囲: 2～10色
  - 明度バリエーション段階数: 1～10段階
  - パレットセルサイズ: 10pt～50pt

### Version 1.0.6 (2026年2月18日)
- **🎨 UI/UX大幅改善**: 全ダイアログの統一的なレイアウト実現
  - **BaseDialog.csの拡張**:
    - `AddStandardButtons()`メソッドにカスタムサイズ対応を追加
    - ボタン幅・高さをパラメータで指定可能に
    - ボタン位置を動的計算：`xPosition = ClientSize.Width - (buttonWidth * 2 + ButtonSpacing + ButtonRightMargin)`
  - **ボタン配置の完全統一**:
    - ボタン間スペース: ButtonSpacing = 10px（全ダイアログで統一）
    - ボタン右端マージン: ButtonRightMargin = 20px
    - カスタムサイズでも正確な位置計算
  - **マジックナンバーの完全排除**:
    - すべてのマージン・スペースを定数化
    - レイアウト計算式の一元化
    - 保守性の大幅向上
  - **影響を受けたダイアログ**: ShapeReplacementDialog、LayerAdjustmentDialog、NumberingDialog

- **🐛 バグ修正**: ナンバリング機能の例外処理
  - **問題**: 1個の図形選択時に`shapes`がnullになる
  - **原因**: `RibbonHelper.GetMultipleSelectedShapes()`が常に最小2個を要求
  - **解決策**:
    - `GetMultipleSelectedShapes()`にminimumCountパラメータを追加
    - ナンバリング機能で`MIN_SHAPES_FOR_NUMBERING = 1`を指定
    - 1個の図形からナンバリング可能に

- **🔧 API改善**: RibbonHelper.csの柔軟性向上
  - `GetMultipleSelectedShapes(int minimumCount = Constants.MIN_SHAPES_FOR_ALIGNMENT)`
  - デフォルト値は2（既存機能に影響なし）
  - 機能ごとに最小要件を指定可能

---
**MagosaAddIn** - PowerPointでの図形操作をより効率的に！
